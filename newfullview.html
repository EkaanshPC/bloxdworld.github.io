<!DOCTYPE html>
<!DOCTYPE html>
<html lang="en">
<head>
<!-- 🎨 Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Fredoka&display=swap" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
<!-- 🖼️ Favicon -->
<link rel="icon" type="image/png" sizes="32x32" href="https://bloxdworld.pages.dev/assets/pixil-frame-0%20%2814%29.png">
<link rel="apple-touch-icon" href="https://bloxdworld.pages.dev/assets/pixil-frame-0%20%2814%29.png">

<!-- ⚡ Meta -->
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="google-site-verification" content="uwGK_wrZ8HW1YDPlIVdaqyOErueoMH5-9DF-fXL7uSc" />
<title>Preview Mod | Bloxd World</title>
<meta name="description" content="Bloxd World is a community-driven modding site where you can upload, vote, and explore creative mods for Bloxd. Built by NeonJet Studios.">
<meta name="keywords" content="BloxdWorld, Bloxd mods, Bloxd.io mods, NeonJet Studios, ObiloxYT, modding, leaderboards">
<meta name="author" content="NeonJet Studios">

<!-- 🟦 Open Graph (Facebook/Discord) -->
<meta property="og:type" content="website">
<meta property="og:site_name" content="Bloxd World">
<meta property="og:url" content="https://bloxdworld.pages.dev">
<meta property="og:title" content="Bloxd World – Share and Discover Mods">
<meta property="og:description" content="Upload and explore mods for Bloxd. Vote, sort, and share your creations.">
<meta property="og:image" content="https://bloxdworld.pages.dev/THE%20PLACE%20FOR.png">
<meta property="og:image:alt" content="Bloxd World Preview Image">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">

<!-- 🐦 Twitter -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Bloxd World – Share and Discover Mods">
<meta name="twitter:description" content="Upload and explore mods for Bloxd. Vote, sort, and share your creations.">
<meta name="twitter:image" content="https://bloxdworld.pages.dev/THE%20PLACE%20FOR.png">

<!-- 🎨 Theme -->
<meta name="theme-color" content="#00c3ff">

<!-- 🎭 Styles -->
<link rel="stylesheet" href="styles/earth-cube.css">
<link rel="stylesheet" href="styles/header.css">
<link rel="stylesheet" href="styles/devlogandindex.css">
<link rel="stylesheet" href="styles/other.css">
<link rel="stylesheet" href="styles/navbar.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<!-- 📊 Structured Data (SEO JSON-LD) -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "Bloxd World",
  "url": "https://bloxdworld.pages.dev",
  "description": "Bloxd World is a community-driven modding site where you can upload, vote, and explore creative mods for Bloxd.",
  "publisher": {
    "@type": "Organization",
    "name": "NeonJet Studios",
    "logo": {
      "@type": "ImageObject",
      "url": "https://bloxdworld.pages.dev/assets/pixil-frame-0%20%2814%29.png"
    }
  },
  "potentialAction": {
    "@type": "SearchAction",
    "target": "https://bloxdworld.pages.dev/search?q={search_term_string}",
    "query-input": "required name=search_term_string"
  }
}
</script>

<style>
/* 🌙 Dark Mode */
.dark-mode {
  background: #121212;
  color: #e0e0e0;
}

.dark-mode .modrinth-style {
  background: #1e1e1e;
  box-shadow: 0 0 24px rgba(0, 0, 0, 0.6);
}

.dark-mode .mod-title {
  color: #f5f5f5;
}

.dark-mode .mod-meta span {
  color: #aaa;
}

.dark-mode .description {
  background: #1c1c1c;
  border-color: #333;
  color: #ddd;
}

.dark-mode #codeSnippet {
  background: #0d1117;
  color: #e6edf3;
}

.dark-mode #copyButton {
  background: #6a0dad;
}

.dark-mode #copyButton:hover {
  background: #580a9d;
}

.dark-mode .analytics-bars-container {
  background: #1c1c1c;
  border-color: #333;
}

.dark-mode .day-label {
  color: #aaa;
}

.dark-mode .day-value {
  color: #f0f0f0;
}

.dark-mode .progress-bar-container {
  background: #333;
}

/* 🌞 Light Mode (default) */
body {
  font-family: 'Fredoka', sans-serif;
  background: #f5f5f5;
  margin: 0;
  padding: 0;
}

.modrinth-style {
  max-width: 900px;
  margin: 40px auto;
  padding: 20px;
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 0 24px rgba(0, 0, 0, 0.04);
  position: relative; /* needed if we want to pin mod-meta inside */
}

.mod-header {
  display: flex;
  gap: 20px;
  align-items: left;
  margin-bottom: 20px;
  flex-wrap: wrap; /* better for smaller screens */
}

.mod-icon {
  width: 72px;
  height: 72px;
  border-radius: 12px;
  object-fit: cover;
  background: #f0f0f0;
}

.mod-title {
  margin: 0;
  font-size: 2em;
  color: #1a1a1a;
  text-align: left;
}

.mod-meta {
  margin-top:290px;
  padding: 15px;
  width:125px;
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 0 24px rgba(0, 0, 0, 0.08);
  position: absolute;
  right: 20px;   /* stay inside, not outside */
  top: 20px;
  font-size: 0.9em;
  color: #444;
}
.right-card {
    margin-top:450px;
  padding: 15px;
  width:125px;
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 0 24px rgba(0, 0, 0, 0.08);
  position: absolute;
  right: 20px;   /* stay inside, not outside */
  top: 20px;
  font-size: 0.9em;
  color: #444;
}
.mod-meta span {
  display: block;
  margin-bottom: 8px;
}

.description {
  text-align: left;
  background: #f9f9f9;
  padding: 18px;
  border-radius: 10px;
  border: 1px solid #e0e0e0;
  white-space: pre-wrap;        /* keeps line breaks */
  word-break: break-word;       /* breaks super long words */
  overflow-wrap: anywhere;      /* ensures content wraps nicely */
  max-width: 100%;
  max-height: 400px;            /* optional scroll limit */
  overflow-y: auto;
  margin-top: 10px;
}

#codeSnippet {
  background: #282c34;
  color: #e6e6e6;
  padding: 14px;
  border-radius: 8px;
  font-family: 'Fira Code', monospace;
  overflow-x: auto;
  text-align: left;
}

#copyButton {
  margin-top: 8px;
  padding: 8px 16px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  background: #00b894;
  color: white;
  transition: background 0.2s ease;
}

#copyButton:hover {
  background: #009e7a;
}

.analytics-bars-container {
  display: flex;
  gap: 15px;
  align-items: flex-end;
  height: 200px;
  padding: 10px;
  background: #f0f0f0;
  border-radius: 8px;
  border: 1px solid #e0e0e0;
  justify-content: center;
  max-width: 100%;
  overflow-x: auto;
  margin-top: 20px;
}

.day-bar-wrapper {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-end;
  height: 100%;
  min-width: 40px;
}

.day-label {
  font-size: 0.8em;
  color: #555;
  margin-bottom: 5px;
  flex-shrink: 0;
}

.progress-bar-container {
  width: 25px;
  height: 100%;
  background: #ddd;
  border-radius: 5px;
  overflow: hidden;
  position: relative;
  flex-grow: 1;
  margin-bottom: 5px;
}

.progress-bar-fill {
  width: 100%;
  height: 0%;
  background: #6a0dad;
  position: absolute;
  bottom: 0;
  left: 0;
  transition: height 0.5s ease-in-out;
  border-radius: 5px;
}

.day-value {
  font-size: 0.9em;
  font-weight: bold;
  color: #333;
  flex-shrink: 0;
}

.tab-bar {
  display: flex;
}

.tab {
  padding: 10px 20px;
  text-decoration: none;
  font-weight: bold;
  color: black;
  background-color: white;
  border: none;
}

.tab.active {
  background-color: #01ffbf;
  color: white;
}

</style>
</head>
<body>
<div class="modrinth-navbar">
  <div class="header">
    
    <!-- Left: Logo -->
    <div class="header-left">
      <div style="display: flex; align-items: center; height: 100%;">
        <div class="cube-container">
          <div class="cube">
            <div class="face front"></div>
            <div class="face back"></div>
            <div class="face right"></div>
            <div class="face left"></div>
            <div class="face top"></div>
            <div class="face bottom"></div>
          </div>
        </div>
      </div>
      <div class="logo-text">Bloxd<br>World</div>
    </div>

    <!-- Right: Navbar + Auth split -->
    <div class="header-right">
      <div class="navbar-wrapper">
        <ul class="navbar">
          <li class="nav-item">
            <a href="index.html"><i class="fas fa-home"></i><span class="nav-label">Home</span></a>
          </li>
          <li class="nav-item">
            <a href="mods.html"><i class="fas fa-cubes"></i><span class="nav-label">Mods</span></a>
          </li>
          <li class="nav-item">
            <a href="upload.html"><i class="fas fa-upload"></i><span class="nav-label">Upload</span></a>
          </li>
          <li class="nav-item">
            <a href="about.html"><i class="fas fa-info-circle"></i><span class="nav-label">About</span></a>
          </li>
          <li class="nav-item">
            <a href="leaderboard.html"><i class="fas fa-trophy"></i><span class="nav-label">Leaderboard</span></a>
          </li>
          <li class="nav-item">
            <a href="#" id="themeToggle"><i class="fas fa-moon"></i><span class="nav-label">Theme</span></a>
          </li>
        </ul>
      </div>
      <div class="auth-wrapper" id="authArea">
        <!-- Auth content here -->
      </div>
    </div>

  </div>
</div>


<div class="mod-header">
  <img src="" alt="Mod Icon" class="mod-icon" id="modIcon" style="margin-left:205px;">
  <div>
    <h1 class="mod-title" id="modTitle">Loading...</h1>
               <p id="shortDescription" style="text-align:left;">Loading short description...  <span style="margin-left:10px">|</span>  <strong style="margin-left:10px;"><i class="fa-solid fa-tags"></i></strong> <span id="category">Uncategorized</span> <span style="margin-left:10px">|</span> <i class="fas fa-file-code" style="margin-left:10px;"></i><span id="typeofcode" style="margin-left:7px">Not Specified</span><span style="margin-left:10px">|</span></p>
</div>
    <button id="copyButton" style="height:30px;border-radius:0px;margin-top:50px">Copy Latest Version</button>
  </div>
  <br/>
</div>
<hr style="width: 69%; margin-bottom:10px; border: 2px solid;">
  <div class="mod-description">
  
  <div class="mod-meta">
        <span><strong>Uploaded:</strong> <span id="uploadDate">...</span></span><br/>
        <hr/>
        <span><strong>By:</strong> <span id="uploaderName">...</span></span>
</div>
  <div class="right-card">
        <span><strong>Feel something is wrong with this mod? report us here:</strong> (soon) </span><br/>
</div>
        <div class="tab-bar" style="margin-left:210px;">
    <a href="/newfullview" class="tab active" id="descriptionbutton">Description</a>
    <a href="/versions" class="tab" id="modversions">Versions</a>
  </div>
<div id="mod-detail-page" class="modrinth-style">
    <p id="description" class="description">Loading description...</p>
      <div class="mod-code">
  </div>
  </div>
<!--
  <div class="analytics-bars-container">
  <div class="day-bar-wrapper">
    <span class="day-label">Day 1</span>
    <div class="progress-bar-container"><div class="progress-bar-fill" id="day1Fill"></div></div>
    <span class="day-value" id="day1Value">N/A</span>
  </div>
  <div class="day-bar-wrapper">
    <span class="day-label">Day 2</span>
    <div class="progress-bar-container"><div class="progress-bar-fill" id="day2Fill"></div></div>
    <span class="day-value" id="day2Value">N/A</span>
  </div>
  <div class="day-bar-wrapper">
    <span class="day-label">Day 3</span>
    <div class="progress-bar-container"><div class="progress-bar-fill" id="day3Fill"></div></div>
    <span class="day-value" id="day3Value">N/A</span>
  </div>
  <div class="day-bar-wrapper">
    <span class="day-label">Day 4</span>
    <div class="progress-bar-container"><div class="progress-bar-fill" id="day4Fill"></div></div>
    <span class="day-value" id="day4Value">N/A</span>
  </div>
  <div class="day-bar-wrapper">
    <span class="day-label">Day 5</span>
    <div class="progress-bar-container"><div class="progress-bar-fill" id="day5Fill"></div></div>
    <span class="day-value" id="day5Value">N/A</span>
  </div>
</div>
-->
</div>

<script type="module">
  Toastify({
  text: "This is still in alpha testing!",
  duration: 3000,
  gravity: "bottom", // bottom or top
  position: "right", // left, center, right
  backgroundColor: "linear-gradient(to right, #FF0000, #D3D3D3)",
  close: true,
}).showToast();
const supabaseUrl = "https://pxmsgzfufvwxpnyeobwk.supabase.co";
const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB4bXNnemZ1ZnZ3eHBueWVvYndrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE3NjU1OTksImV4cCI6MjA2NzM0MTU5OX0.-fRzI_259AIkq60Ck7PcgpX2SThnp8rBwVGglKxgY2U";
const client = supabase.createClient(supabaseUrl, supabaseKey);

function formatDescription(raw) {
  if(!raw) return 'No description provided.';
  return raw.replace(/\n/g,'<br>')
            .replace(/\*(.*?)\*/g,'<strong>$1</strong>')
            .replace(/_(.*?)_/g,'<u>$1</u>')
            .replace(/`(.*?)`/g,'<code>$1</code>');
}

document.addEventListener("DOMContentLoaded", async ()=>{
  const params = new URLSearchParams(window.location.search);
  const addonId = params.get("addonid");
  if(!addonId) {
    Toastify({
  text: "No AddonId found in URL!",
  duration: 3000,
  gravity: "bottom", // bottom or top
  position: "right", // left, center, right
  backgroundColor: "linear-gradient(to right, #FF0000, #D3D3D3)",
  close: true,
}).showToast();
    return console.error("No Addon ID in URL");}

  const { data, error } = await client
    .from("mod")
    .select("*")
    .eq("id", addonId)
    .single();
    document.getElementById("descriptionbutton").href="https://bloxdworld.pages.dev/newfullview?addonid="+addonId
        document.getElementById("modversions").href="https://bloxdworld.pages.dev/versions?addonid="+addonId
  if(error) {
    Toastify({
  text: `Error while finding mod: ${error}`,
  duration: 3000,
  gravity: "bottom", // bottom or top
  position: "right", // left, center, right
  backgroundColor: "linear-gradient(to right, #FF0000, #D3D3D3)",
  close: true,
}).showToast();
    return console.error(error);}

  const mod = data;
  console.log("data got! it is:",mod)
  document.getElementById("modTitle").textContent = mod.title;
  document.getElementById("uploadDate").textContent = mod.created_at.split("T")[0];
  document.getElementById("uploaderName").textContent = mod.author || "Anonymous";
  document.getElementById("category").textContent = mod.category || "Uncategorized";
 document.getElementById("shortDescription").textContent= mod.shortdescription || "No Info"
  document.getElementById("description").innerHTML = mod.description
  window.getLink = async (filePath) => {
    const { data } = client.storage.from("mod").getPublicUrl(filePath);
    if (data?.publicUrl) {
      return data;
    }
  };
  const fileUrl = `https://pxmsgzfufvwxpnyeobwk.supabase.co/storage/v1/object/public/mod/${mod.file_path}`;
  fetch(fileUrl)
  .then(res => res.text())
  .then(data => {
console.log(`Code found! ${data}`)
    document.getElementById("codeSnippet").textContent = data;
  });
  document.getElementById("modIcon").src = mod.icon || "https://bloxdworld.pages.dev/assets/pixil-frame-0%20%2814%29.png";


  document.getElementById("copyButton").addEventListener("click",()=>{
    navigator.clipboard.writeText('Bloxdworld: soon').then(()=>{Toastify({
  text: "Code copied to clipboard!",
  duration: 3000,
  gravity: "bottom", // bottom or top
  position: "right", // left, center, right
  backgroundColor: "linear-gradient(to right, #ADD8E6, #D3D3D3)",
  close: true,
}).showToast();});
  });
});
const themeToggle = document.getElementById("themeToggle");

// Apply saved theme on load
if (localStorage.getItem("theme") === "dark") {
  document.body.classList.add("dark-mode");
}

// Toggle and save preference
themeToggle.addEventListener("click", (e) => {
  e.preventDefault();
  document.body.classList.toggle("dark-mode");

  // Save preference
  if (document.body.classList.contains("dark-mode")) {
    localStorage.setItem("theme", "dark");
  } else {
    localStorage.setItem("theme", "light");
  }
});
</script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script type="module" src="js/googlelogin.js"></script>
</body>
</html>
