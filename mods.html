<!DOCTYPE html>
<html lang="en">
<head>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

  <meta charset="UTF-8">
  <title>Mods | Bloxd World</title>
<meta name="description" content="Bloxd World is a community-driven modding site where you can upload, vote, and explore creative mods for Bloxd. Built by NeonJet Studios.">
<meta property="og:title" content="Mods">
<meta property="og:description" content="Explore Bloxd Mods!">
<meta property="og:image" content="https://bloxdworld.pages.dev/THE PLACE FOR.png">
<meta property="og:url" content="https://bloxdworld.pages.dev/mods">
<meta name="twitter:card" content="summary_large_image">
  <link href="https://fonts.googleapis.com/css2?family=Fredoka&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<link rel="stylesheet" href="styles/earth-cube.css">
<link rel="stylesheet" href="styles/header.css">
<link rel="stylesheet" href="styles/devlogandindex.css">
<link rel="stylesheet" href="styles/other.css">
<link rel="stylesheet" href="styles/navbar.css">   <style>
body.mobile .mods-container,
body.mobile .devlog-container {
  padding: 10px;
}
.mod-card button {
  align-self: flex-start; /* Aligns the button to the left in a flex container */
  margin-top: 10px;       /* Optional spacing */
}
.mod-icon{
width:140px;
height:140px;
  object-fit: cover;
  border-radius: 8px;
  flex-shrink: 0;
}
.mod-content {
  flex: 1;
  display: flex;
  flex-direction: column;
}
body.mobile .mod-card {
  padding: 12px;
  margin-bottom: 16px;
  font-size: 0.95rem;
  border-radius: 10px;
}

body.mobile .mod-card img {
  max-width: 100%;
  height: auto;
  display: block;
  margin: 10px auto;
}

body.mobile .vote-icon {
  width: 28px;
  margin-right: 8px;
}

body.mobile .nav-links {
  flex-direction: column;
  gap: 10px;
  align-items: center;
}

body.mobile .search-bar {
  width: 90%;
  font-size: 1rem;
}

    body {
  margin: 0;
  font-family: 'Fredoka', sans-serif;
  background-color: #f0f0f0;
  color: #000;
  transition: background-color 0.3s ease, color 0.3s ease;
}
.vote-icon {
  pointer-events: auto;
  z-index: 10;
  position: relative;
}

.mods-container {
  max-width: 1000px;
  margin: 40px auto;
  padding: 20px;
}

.mods-header {
  font-size: 28px;
  margin-bottom: 20px;
  color: #00a7a9;
  text-align: center;
}
/* Shared base style */
.search-bar,
#categoryFilter {
  display: block;
  margin: 0 auto 20px;
  padding: 10px 12px;
  font-size: 16px;
  width: 300px;
  border-radius: 6px;
  border: 1px solid #ccc;
  background-color: #fff;
  color: #333;
  transition: box-shadow 0.3s ease, border-color 0.3s ease;
  outline: none;
}

/* Glow on hover and focus */
.search-bar:hover,
.search-bar:focus,
#categoryFilter:hover,
#categoryFilter:focus {
  border-color: #00ffff;
  box-shadow: 0 0 8px rgba(0, 255, 255, 0.6);
}

/* Optional: dark mode support */
body.dark .search-bar,
body.dark #categoryFilter {
  background-color: #222;
  color: #eee;
  border-color: #444;
}

body.dark .search-bar:hover,
body.dark .search-bar:focus,
body.dark #categoryFilter:hover,
body.dark #categoryFilter:focus {
  border-color: #00ffff;
  box-shadow: 0 0 8px rgba(0, 255, 255, 0.6);
}


.mod-card {
display: flex;
  background: white;
  border-radius: 8px;
  padding: 20px;
  margin-bottom: 20px;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
  transition: background-color 0.3s ease, box-shadow 0.3s ease;
  gap: 16px;
max-width: 100%;
  box-sizing: border-box;
  overflow-wrap: break-word;
}

.mod-card:hover {
  box-shadow: 0 0 12px rgba(0, 255, 255, 0.6), 0 0 24px rgba(0, 255, 255, 0.4);
}


.mod-card h3 {
  margin-top: 0;
text-align:left;
  color: #007c7e;
}

.mod-card p {
  margin: 10px 0 0;
text-align:left;
  color: #333;
}
.mod-description {
  font-size: 1.05em;
  color: #1a1a1a;
  background: #f5fafd;
  border-left: 4px solid #2196f3;
  padding: 12px 16px;
  margin: 16px 0;
  border-radius: 8px;
  font-family: 'Fredoka', sans-serif;
  box-shadow: 0 2px 6px rgba(33, 150, 243, 0.08);
  transition: background 0.3s, color 0.3s, border-color 0.3s;
}

body.dark-mode .mod-description {
  background: #1e2a36;
  color: #e0f7fa;
  border-left-color: #64d8cb;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
}
.mod-card img {
  max-width: 100%;
text-align:left;
  border-radius: 6px;
  margin-top: 10px;
}

.mod-details {
text-align:left;
  display: none;
  margin-top: 10px;
}

.mod-details pre {
text-align:left;
  font-family: 'Courier New', monospace;
  background-color: #f5f5f5;
  padding: 10px;
  border-radius: 6px;
  overflow-x: auto;
  margin-top: 10px;
  word-break: break-word;
  white-space: pre-wrap;
  max-width: 100%;
}

.vote-btn {
  margin-top: 10px;
  padding: 6px 12px;
  border: none;
  border-radius: 4px;
  background-color: #007c7e;
  color: white;
  cursor: pointer;
  transition: box-shadow 0.3s ease, background-color 0.3s ease;
}

.vote-btn:hover {
  background-color: #009fa1;
  box-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
}


img.vote-icon:hover {
  transform: scale(1.1);
  transition: transform 0.2s ease;
}

/* ðŸŒ™ Dark Mode Styles */
body.dark-mode {
  background-color: #111;
  color: #eee;
}

body.dark-mode .mod-card {
  background-color: #222;
}

body.dark-mode .mod-card p {
  color: #ccc;
}

body.dark-mode .mod-card h3 {
  color: #00e0e2;
}

body.dark-mode .mod-details pre {
  background-color: #333;
  color: #ddd;
}

body.dark-mode .search-bar {
  background-color: #222;
  color: #eee;
  border-color: #555;
}

body.dark-mode .vote-btn {
  background-color: #009fa1;
}

/* ðŸ“± Responsive */
@media (max-width: 600px) {
  .mods-container {
    padding: 10px;
  }
  .mod-card {
    padding: 15px;
  }
  .search-bar {
    width: 90%;
  }
}
#sortVotes {
  display: block;
  margin: 10px auto 30px;
  padding: 10px 16px;
  font-size: 16px;
  border: none;
  border-radius: 6px;
  background-color: #007c7e;
  color: white;
  cursor: pointer;
  transition: background-color 0.3s ease, box-shadow 0.3s ease;
}

#sortVotes:hover {
  background-color: #009fa1;
  box-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
}

/* Optional: dark mode support */
body.dark #sortVotes {
  background-color: #005f61;
  color: #eee;
}

body.dark #sortVotes:hover {
  background-color: #008b8d;
  box-shadow: 0 0 10px rgba(0, 255, 255, 0.6);
}
@media (max-width: 600px) {
  .mod-card {
    flex-direction: column;
    align-items: center;
  }

  .mod-icon {
    width: 100px;
    height: 100px;
    margin-bottom: 12px;
  }

  .mod-content {
    align-items: center;
    text-align: center;
  }
}
/* AI summary styling */
.ai-summary {
  opacity: 0;
  display: none;
  font-style: italic;
  color: #00cccc;
  background: rgba(0, 255, 255, 0.05);
  border-left: 3px solid #00cccc;
  padding: 8px 12px;
  margin-top: 10px;
  border-radius: 4px;
  transition: opacity 0.3s ease;
  font-size: 0.95em;
  line-height: 1.4;
  max-width: 100%;
  word-wrap: break-word;
}

.ai-summary.show {
  display: block;
  opacity: 1;
}
  </style>
</head>
<body>

  <div class="header">
    <div class="header-left">
<div style="display: flex; align-items: center; height: 100%;">
        <div class="cube-container">
          <div class="cube">
            <div class="face front"></div>
            <div class="face back"></div>
            <div class="face right"></div>
            <div class="face left"></div>
            <div class="face top"></div>
            <div class="face bottom"></div>
          </div>
        </div>
      </div>
      <div class="logo-text"> Bloxd <br>World</div>
    </div>
   <div class="header-right">
  <ul class="navbar">
    <li class="nav-item">
      <a href="index.html">
        <i class="fas fa-home"></i>
        <span class="nav-label">Home</span>
      </a>
    </li>
    <li class="nav-item">
      <a href="mods.html">
        <i class="fas fa-cubes"></i>
        <span class="nav-label">Mods</span>
      </a>
    </li>
    <li class="nav-item">
      <a href="upload.html">
        <i class="fas fa-upload"></i>
        <span class="nav-label">Upload</span>
      </a>
    </li>
    <li class="nav-item">
      <a href="about.html">
        <i class="fas fa-info-circle"></i>
        <span class="nav-label">About</span>
      </a>
    </li>
    <li class="nav-item">
      <a href="leaderboard.html">
        <i class="fas fa-trophy"></i>
        <span class="nav-label">Leaderboard</span>
      </a>
    </li>
    <li class="nav-item">
      <a href="#" id="themeToggle">
        <i class="fas fa-moon"></i>
        <span class="nav-label">Theme</span>
      </a>
    </li>
    <li class="nav-item" id="authArea"></li>
  </ul>
    </div>
  </div>

  <div class="mods-container">
    <div class="mods-header">Community Mods</div>
    <input type="text" id="search" class="search-bar" placeholder="Search mods...">
<select id="categoryFilter">
<option selected value="">OTHER</option>
<option value="Gameplay">Gameplay</option>
<option value="Visual">Visual</option>
<option value="NPC/AI">NPC/AI</option>
<option value="Utilities">Tools/Utilities</option>
<option value="Experimental">Experimental</option>
</select>
<button id="sortVotes">Sort by Votes</button>
    <div id="mods-list">Loading. Please Wait</div>
  </div>
  <div id="pagination" style="text-align: center; margin-top: 20px;"></div>

  <script>
    let currentPage = 1;
const modsPerPage = 10;
console.log("Referrer:", document.referrer);
const themeToggle = document.getElementById("themeToggle");

// Apply saved theme on load
if (localStorage.getItem("theme") === "dark") {
  document.body.classList.add("dark-mode");
}

// Toggle and save preference
themeToggle.addEventListener("click", (e) => {
  e.preventDefault();
  document.body.classList.toggle("dark-mode");

  // Save preference
  if (document.body.classList.contains("dark-mode")) {
    localStorage.setItem("theme", "dark");
  } else {
    localStorage.setItem("theme", "light");
  }
});


document.getElementById("sortVotes").addEventListener("click", () => {
  const sorted = [...allMods].sort((a,b) => 
    (voteData[b["Addon ID"]] || 0) - (voteData[a["Addon ID"]] || 0)
  );
  renderMods(sorted);
});

document.getElementById("categoryFilter").addEventListener("change", e => {
  const cat = e.target.value.toLowerCase();
  const filtered = allMods.filter(mod => 
    cat === "" || (mod["Category (what type of mod is this?)"] || "").toLowerCase() === cat
  );
  renderMods(filtered);
});

    let allMods = [];
    let voteData = {};
function renderPagination(totalMods) {
  const paginationContainer = document.getElementById("pagination");
  paginationContainer.innerHTML = "";

  const totalPages = Math.ceil(totalMods / modsPerPage);

  const prevBtn = document.createElement("button");
  prevBtn.textContent = "â† Previous";
  prevBtn.disabled = currentPage === 1;
  prevBtn.onclick = () => {
    currentPage--;
    renderMods(allMods);
  };

  const nextBtn = document.createElement("button");
  nextBtn.textContent = "Next â†’";
  nextBtn.disabled = currentPage === totalPages;
  nextBtn.onclick = () => {
    currentPage++;
    renderMods(allMods);
  };

  const pageInfo = document.createElement("span");
  pageInfo.textContent = `Page ${currentPage} of ${totalPages}`;
  pageInfo.style.margin = "0 12px";

  paginationContainer.appendChild(prevBtn);
  paginationContainer.appendChild(pageInfo);
  paginationContainer.appendChild(nextBtn);
}

    function createTextElement(tag, text) {
      const el = document.createElement(tag);
      el.textContent = text;
      return el;
    }
const votedMods = JSON.parse(localStorage.getItem("votedMods") || "{}");
    function renderMods(mods) {
      const container = document.getElementById("mods-list");
      container.innerHTML = "";

      if (mods.length === 0) {
        container.appendChild(createTextElement("p", "No mods found."));
        return;
      }
  const start = (currentPage - 1) * modsPerPage;
  const end = start + modsPerPage;
  const modsToShow = mods.slice(start, end);

      mods.forEach(mod => {
const modId = mod["Addon ID"];

        const card = document.createElement("div");
        card.addEventListener("click", (e) => {
  const isInteractive = e.target.closest("button") || e.target.closest("img.vote-icon");
  if (isInteractive) return;

  window.location.href = `https://bloxdworld.pages.dev/fullview?addonId=${modId}`;
});

        card.className = "mod-card";

        const title = createTextElement("h3", mod["Addon Name"] || "Unnamed Mod");
        const category = createTextElement("p", `Category: ${mod["Category (what type of mod is this?)"] || "Uncategorized"}`);

        const details = document.createElement("div");
        details.className = "mod-details";
        const description = createTextElement("p", mod["About Addon / Description"] || "No description provided.");
const formattedTimestamp = mod["Timestamp"];
        if (formattedTimestamp) {
          const dateElem = createTextElement("p", `Uploaded: ${formattedTimestamp}`);
          details.appendChild(dateElem);
        }


        const author = createTextElement("p", `Made by: ${mod["Author Name (leave blank for your username to be displayed anonymous)"] || "Anonymous"}`);
        author.style.color = "cyan";
        details.appendChild(description);
        description.className = "mod-description";
        details.appendChild(author);
// ðŸ§  AI summary element (hidden by default)
const aiSummary = createTextElement("p", "");
aiSummary.style.display = "none";
aiSummary.style.fontStyle = "italic";
aiSummary.style.color = "#00aaaa";
aiSummary.style.marginTop = "8px";
aiSummary.className = "ai-summary";
details.appendChild(aiSummary);

// Cache to avoid re-fetching
let aiSummaryLoaded = false;

// Show/hide AI summary on hover
card.addEventListener("mouseenter", () => {
aiSummary.style.display = "block"; // override inline display:none
aiSummary.classList.add("show");

  if (!aiSummaryLoaded) {
    aiSummary.textContent = "ðŸ§  Loading AI summary...";

    fetch("https://tooltip-ai-proxy.ekaanshagarwal19564.workers.dev/", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        label: `Mod Name: ${mod["Addon Name"] || "Unnamed"}, Description: ${mod["About Addon / Description"] || "None"}, Code: ${mod["Addon Code"] || "N/A"}, Author: ${mod["Author Name (leave blank for your username to be displayed anonymous)"] || "Anonymous"}`
      })
    })
    .then(res => res.json())
    .then(data => {
      const content = data.choices?.[0]?.message?.content || "No summary available.";
      aiSummary.textContent = `ðŸ§  ${content}`;
      aiSummaryLoaded = true;
    })
    .catch(err => {
      console.error("âŒ Failed to fetch AI summary:", err);
      aiSummary.textContent = "âš ï¸ AI summary unavailable.";
    });
  }
});

card.addEventListener("mouseleave", () => {
  aiSummary.style.display = "none";
aiSummary.classList.remove("show");
});

        if (mod["Image (upload image to imgur, put the link here.)"]) {
          const img = document.createElement("img");
          img.src = mod["Image (upload image to imgur, put the link here.)"];
          img.alt = "Mod Image";
          details.appendChild(img);
        }

        if (mod["Addon Code"]) {
          const codeBlock = document.createElement("pre");
          codeBlock.textContent = mod["Addon Code"];
          details.appendChild(codeBlock);
        }
const copyBtn = document.createElement("button");
copyBtn.textContent = "ðŸ“‹";
copyBtn.className = "vote-btn";
copyBtn.style.background = "none";
copyBtn.style.border = "none";
copyBtn.style.width="30px";
copyBtn.style.height="30px";
copyBtn.style.fontSize="30px";
copyBtn.style.marginLeft = "10px";

copyBtn.addEventListener("click", () => {
  const shareURL = `https://bloxdworld.pages.dev/fullview?addonId=${modId}`;
  navigator.clipboard.writeText(shareURL)
    .then(() => {
      copyBtn.textContent = "âœ…";
      setTimeout(() => {
        copyBtn.textContent = "ðŸ“‹";
      }, 1500);
    })
    .catch(err => {
      console.error("âŒ Failed to copy:", err);
      copyBtn.textContent = "âš ï¸ Failed";
    });
});
        const toggleBtn = document.createElement("button");
        toggleBtn.textContent = "Show More";
        toggleBtn.className = "vote-btn";
        toggleBtn.addEventListener("click", () => {
          const isVisible = details.style.display === "block";
          details.style.display = isVisible ? "none" : "block";
          toggleBtn.textContent = isVisible ? "Show More" : "Show Less";
        });

        const voteContainer = document.createElement("div");
        voteContainer.style.marginTop = "10px";

        const upvoteBtn = document.createElement("img");
upvoteBtn.src = "https://bloxdworld.pages.dev/pixil-frame-0%20(12).png";
upvoteBtn.alt = "Upvote";
upvoteBtn.style.width = "32px";
upvoteBtn.style.cursor = "pointer";
upvoteBtn.style.marginRight = "10px";
upvoteBtn.classList.add("vote-icon");


        const voteCount = document.createElement("span");
        let currentVotes = voteData[modId] ? parseInt(voteData[modId]) : 0;
        voteCount.textContent = `${currentVotes}`;

        if (votedMods[modId]) {
  upvoteBtn.src = "https://bloxdworld.pages.dev/pixilart-drawing.png";
  upvoteBtn.alt = "Voted";
  upvoteBtn.style.opacity = "0.7";
  upvoteBtn.title = "Click to remove vote";
} else {
  upvoteBtn.title = "Click to upvote";
}


upvoteBtn.addEventListener("click", () => {
  const hasVoted = votedMods[modId];

  if (hasVoted) {
    // ðŸ”„ Remove vote
    const newVotes = currentVotes - 1;
    voteCount.textContent = ` ${newVotes}`;
    voteData[modId] = newVotes;
    currentVotes = newVotes;

    delete votedMods[modId];
    localStorage.setItem("votedMods", JSON.stringify(votedMods));

    upvoteBtn.src = "https://bloxdworld.pages.dev/pixil-frame-0%20(12).png";
    upvoteBtn.alt = "Upvote";
    upvoteBtn.style.opacity = "1";
    upvoteBtn.title = "Click to upvote";

    fetch("https://bloxdworld.pages.dev/proxy?url=" + encodeURIComponent("https://script.google.com/macros/s/AKfycbyUK1z9W3Xfv8pKvIu7xdAiZy048lSsKL8aYMgKKJzq3lY64RKkcnTqH4dhHIVphCCy/exec"), {
      method: "POST",
      body: new URLSearchParams({
        name: modId,
        votes: newVotes
      })
    }).then(() => {
      console.log(`ðŸ” Vote for "${modId}" removed.`);
    }).catch(err => {
      console.error(`âŒ Failed to remove vote for "${modId}":`, err);
    });

  } else {
    // âœ… Add vote
    const newVotes = currentVotes + 1;
    voteCount.textContent = ` ${newVotes}`;
    voteData[modId] = newVotes;
    currentVotes = newVotes;

    votedMods[modId] = true;
    localStorage.setItem("votedMods", JSON.stringify(votedMods));

    upvoteBtn.src = "https://bloxdworld.pages.dev/pixilart-drawing.png";
    upvoteBtn.alt = "Voted";
    upvoteBtn.style.opacity = "0.7";
    upvoteBtn.title = "Click to remove vote";

    fetch("https://bloxdworld.pages.dev/proxy?url=" + encodeURIComponent("https://script.google.com/macros/s/AKfycbyUK1z9W3Xfv8pKvIu7xdAiZy048lSsKL8aYMgKKJzq3lY64RKkcnTqH4dhHIVphCCy/exec"), {
      method: "POST",
      headers: {
        "Content-Type": "application/x-www-form-urlencoded"
      },
      body: new URLSearchParams({
        name: modId,
        votes: newVotes
      })
    })
    .then(() => {
      console.log(`âœ… Vote for "${modId}" submitted successfully.`);
    })
    .catch(err => {
      console.error(`âŒ Failed to submit vote for "${modId}":`, err);
    });
  }
});
  

        voteContainer.appendChild(upvoteBtn);
        voteContainer.appendChild(voteCount);
voteContainer.appendChild(copyBtn);

const contentWrapper = document.createElement("div");
contentWrapper.className = "mod-content";

// Add title, category, details, voteContainer to contentWrapper
contentWrapper.appendChild(title);
contentWrapper.appendChild(category);
contentWrapper.appendChild(details);
contentWrapper.appendChild(voteContainer);

let icon = document.createElement("img");

if (mod["Mod Icon (samething as Image uploading, but this will be displayed.)"]) {
  icon.src = mod["Mod Icon (samething as Image uploading, but this will be displayed.)"];
} else {
  icon.src = "https://bloxdworld.pages.dev/assets/pixil-frame-0%20%2814%29.png";
}

icon.alt = "Mod Icon";
icon.className = "mod-icon";

card.appendChild(icon);
card.appendChild(contentWrapper);
container.appendChild(card);
      });
renderPagination(mods.length);
    }
    
Promise.all([
  fetch("https://opensheet.vercel.app/1DR9qcrbVIV1uirY5MHHRPSQhuf5n8Cd2zuBb77uEZWg/Form%20Responses%201").then(res => res.json())
])
.then(([mods]) => {
  if (!Array.isArray(mods)) {
    throw new Error("Mods data is not an array");
  }

  allMods = mods.filter(mod => (mod["Approved"] || "").toLowerCase() === "true");
  renderMods(allMods);
})
.catch(err => {
  const container = document.getElementById("mods-list");
  container.appendChild(createTextElement("p", "âš ï¸ Failed to load mods. Check console for details."));
  console.error("âŒ Error loading mods:", err);
});

fetch("https://bloxdworld.pages.dev/proxy?url=" + encodeURIComponent("https://script.google.com/macros/s/AKfycbyUK1z9W3Xfv8pKvIu7xdAiZy048lSsKL8aYMgKKJzq3lY64RKkcnTqH4dhHIVphCCy/exec?action=getVotes"))
  .then(res => res.json())
  .then(votes => {
    voteData = votes;
    renderMods(allMods);
  })
  .catch(err => {
    console.error("âŒ Failed to fetch votes:", err);
  });

    document.getElementById("search").addEventListener("input", e => {
      const query = e.target.value.toLowerCase();
      const filtered = allMods.filter(mod =>
        (mod["Addon Name"] || "").toLowerCase().includes(query) ||
        (mod["About Addon / Description"] || "").toLowerCase().includes(query) ||
        (mod["Author Name (leave blank for your username to be displayed anonymous)"] || "").toLowerCase().includes(query)
      );
      renderMods(filtered);
    });
if (/Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
  document.body.classList.add("mobile");
}

  </script>
<footer class="site-footer">
  <p>Â© NeonJet Studios. <strong>Bloxd World</strong> is made by NeonJet Studios and is not affiliated with Bloxd.io.</p>
  <nav class="footer-links">
    <a href="/about">About</a>
    <a href="/leaderboard">Leaderboard</a>
    <a href="/about">About</a>
    <a href="/upload">Submit a Mod</a>
    <a href="https://discord.gg/yourserver" target="_blank">Join Discord (SOON)</a>
  </nav>
</footer>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="js/googlelogin.js"></script>
</body>
</html>

