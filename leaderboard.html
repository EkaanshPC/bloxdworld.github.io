<!DOCTYPE html>
<html lang="en">
<head>
    <!-- üé® Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Fredoka&display=swap" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
<!-- üñºÔ∏è Favicon -->
<link rel="icon" type="image/png" sizes="32x32" href="https://bloxdworld.pages.dev/assets/pixil-frame-0%20%2814%29.png">
<link rel="apple-touch-icon" href="https://bloxdworld.pages.dev/assets/pixil-frame-0%20%2814%29.png">

<!-- ‚ö° Meta -->
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="google-site-verification" content="uwGK_wrZ8HW1YDPlIVdaqyOErueoMH5-9DF-fXL7uSc" />
<title>Leaderboard | Bloxd World</title>
<meta name="description" content="Bloxd World is a community-driven modding site where you can upload, vote, and explore creative mods for Bloxd. Built by NeonJet Studios.">
<meta name="keywords" content="BloxdWorld, Bloxd mods, Bloxd.io mods, NeonJet Studios, ObiloxYT, modding, leaderboards">
<meta name="author" content="NeonJet Studios">

<!-- üü¶ Open Graph (Facebook/Discord) -->
<meta property="og:type" content="website">
<meta property="og:site_name" content="Bloxd World">
<meta property="og:url" content="https://bloxdworld.pages.dev">
<meta property="og:title" content="Bloxd World ‚Äì Share and Discover Mods">
<meta property="og:description" content="Upload and explore mods for Bloxd. Vote, sort, and share your creations.">
<meta property="og:image" content="https://bloxdworld.pages.dev/THE%20PLACE%20FOR.png">
<meta property="og:image:alt" content="Bloxd World Preview Image">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">

<!-- üê¶ Twitter -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Bloxd World ‚Äì Share and Discover Mods">
<meta name="twitter:description" content="Upload and explore mods for Bloxd. Vote, sort, and share your creations.">
<meta name="twitter:image" content="https://bloxdworld.pages.dev/THE%20PLACE%20FOR.png">

<!-- üé® Theme -->
<meta name="theme-color" content="#00c3ff">

<!-- üé≠ Styles -->
<link rel="stylesheet" href="styles/earth-cube.css">
<link rel="stylesheet" href="styles/header.css">
<link rel="stylesheet" href="styles/devlogandindex.css">
<link rel="stylesheet" href="styles/other.css">
<link rel="stylesheet" href="styles/navbar.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<!-- üìä Structured Data (SEO JSON-LD) -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "Bloxd World",
  "url": "https://bloxdworld.pages.dev",
  "description": "Bloxd World is a community-driven modding site where you can upload, vote, and explore creative mods for Bloxd.",
  "publisher": {
    "@type": "Organization",
    "name": "NeonJet Studios",
    "logo": {
      "@type": "ImageObject",
      "url": "https://bloxdworld.pages.dev/assets/pixil-frame-0%20%2814%29.png"
    }
  },
  "potentialAction": {
    "@type": "SearchAction",
    "target": "https://bloxdworld.pages.dev/search?q={search_term_string}",
    "query-input": "required name=search_term_string"
  }
}
</script>
  <style>
.mod-of-the-day {
  margin-bottom: 30px;
  text-align: center;
  font-size: 1.2rem;
  font-weight: bold;
  color: #f5c542; /* softer gold */
  text-shadow: 0 0 2px rgba(245, 197, 66, 0.5);
}

.mod-card.featured {
  border: 2px solid #f5c542;
  background-color: #1a1a1a;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 0 8px rgba(245, 197, 66, 0.2);
  transition: box-shadow 0.3s ease, transform 0.2s ease;
}

.mod-card.featured:hover {
  box-shadow: 0 0 12px rgba(245, 197, 66, 0.4), 0 0 20px rgba(245, 197, 66, 0.3);
  transform: translateY(-2px);
}

.textwhiteonly{
color:white;
}
.mods-container {
  display: flex;
  flex-direction: column;
  align-items: center; /* ‚úÖ This centers all child mod cards horizontally */
  padding: 20px;
}
/* üåü Mod of the Day */
.mod-of-the-day {
  background-color: #fff;
  border-left: 4px solid #ffc107;
  padding: 1.5rem;
  margin: 2rem auto;
  max-width: 700px;
  border-radius: 10px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
  font-family: 'Segoe UI', sans-serif;
}

.mod-of-the-day h2 {
  margin-top: 0;
  font-size: 1.6rem;
  color: #ff9800;
}

.mod-of-the-day p {
  font-size: 1rem;
  color: #333;
}

/* üèÜ Leaderboard Section */
.mods-container {
  background-color: #f9f9f9;
  padding: 2rem;
  max-width: 700px;
  margin: 2rem auto;
  border-radius: 10px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
}

.mods-header {
  font-size: 1.5rem;
  font-weight: bold;
  color: #007bff;
  margin-bottom: 1rem;
}

#leaderboard-list {
  font-size: 1rem;
  color: #555;
  padding: 1rem;
  background-color: #fff;
  border-radius: 6px;
  box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05);
}

/* üåô Dark Mode Compatibility */
.dark-mode .mod-of-the-day {
  background-color: #2a2a2a;
  border-left: 4px solid #ffb74d;
}

.dark-mode .mod-of-the-day h2 {
  color: #ffcc80;
}

.dark-mode .mod-of-the-day p {
  color: #ddd;
}

.dark-mode .mods-container {
  background-color: #1e1e1e;
}

.dark-mode .mods-header {
  color: #66b2ff;
}

.dark-mode #leaderboard-list {
  background-color: #2a2a2a;
  color: #ccc;
  box-shadow: inset 0 1px 3px rgba(255, 255, 255, 0.05);
}

  </style>
</head>
<body>
<div class="modrinth-navbar">
  <div class="header">
    
    <!-- Left: Logo -->
    <div class="header-left">
      <div style="display: flex; align-items: center; height: 100%;">
        <div class="cube-container">
          <div class="cube">
            <div class="face front"></div>
            <div class="face back"></div>
            <div class="face right"></div>
            <div class="face left"></div>
            <div class="face top"></div>
            <div class="face bottom"></div>
          </div>
        </div>
      </div>
      <div class="logo-text">Bloxd<br>World</div>
    </div>

    <!-- Right: Navbar + Auth split -->
    <div class="header-right">
      <div class="navbar-wrapper">
        <ul class="navbar">
          <li class="nav-item">
            <a href="index.html"><i class="fas fa-home"></i><span class="nav-label">Home</span></a>
          </li>
          <li class="nav-item">
            <a href="mods.html"><i class="fas fa-cubes"></i><span class="nav-label">Mods</span></a>
          </li>
          <li class="nav-item">
            <a href="upload.html"><i class="fas fa-upload"></i><span class="nav-label">Upload</span></a>
          </li>
          <li class="nav-item">
            <a href="about.html"><i class="fas fa-info-circle"></i><span class="nav-label">About</span></a>
          </li>
          <li class="nav-item">
            <a href="leaderboard.html"><i class="fas fa-trophy"></i><span class="nav-label">Leaderboard</span></a>
          </li>
          <li class="nav-item">
            <a href="#" id="themeToggle"><i class="fas fa-moon"></i><span class="nav-label">Theme</span></a>
          </li>
        </ul>
      </div>
      <div class="auth-wrapper" id="authArea">
        <!-- Auth content here -->
      </div>
    </div>

  </div>
</div>

<!-- üåü Mod of the Day -->
<div id="mod-of-the-day" class="mod-of-the-day">
  <h2>üåü Mod of the Day</h2>
  <p>Loading featured mod...</p>
</div>

<!-- üèÜ Top Mods Leaderboard -->
<div class="mods-container">
  <div class="mods-header">üèÜ Top Mods Leaderboard</div>
  <div id="leaderboard-list">Loading leaderboard...</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script type="module" src="js/googlelogin.js"></script>
  <script>
    const client = supabase.createClient(
  "https://pxmsgzfufvwxpnyeobwk.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB4bXNnemZ1ZnZ3eHBueWVvYndrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE3NjU1OTksImV4cCI6MjA2NzM0MTU5OX0.-fRzI_259AIkq60Ck7PcgpX2SThnp8rBwVGglKxgY2U",
  {
    auth: {
      persistSession: true,         // ‚úÖ Keeps user logged in across reloads
      autoRefreshToken: true,       // ‚úÖ Refreshes JWTs automatically
      storage: localStorage         // ‚úÖ Stores session in browser
    }
  }
);
if (/Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
  document.body.classList.add("mobile");
}

const leaderboardContainer = document.getElementById("leaderboard-list");
const modContainer = document.getElementById("mod-of-the-day");

async function loadLeaderboard() {
  try {
    // üîÅ Fetch vote counts from Supabase
    const { data: votes, error: voteError } = await client
      .from("votes")
      .select("addon_id", { count: "exact" });

    if (voteError) throw voteError;

    // üîÅ Fetch mod metadata from Google Sheet
    const modsRes = await fetch("https://opensheet.vercel.app/1DR9qcrbVIV1uirY5MHHRPSQhuf5n8Cd2zuBb77uEZWg/Form%20Responses%201");
    const mods = await modsRes.json();

    // üîÅ Fetch Mod of the Day from Google Sheet
    const dailyRes = await fetch("https://opensheet.vercel.app/1DR9qcrbVIV1uirY5MHHRPSQhuf5n8Cd2zuBb77uEZWg/Form%20Responses%203");
    const dailyMods = await dailyRes.json();

    const approvedMods = mods.filter(mod => (mod["Approved"] || "").toLowerCase() === "true");

    // üîç Build a map of Addon ID ‚Üí mod object
    const modMap = {};
    approvedMods.forEach(mod => {
      if (mod["Addon ID"]) {
        modMap[mod["Addon ID"]] = mod;
      }
    });

    // üßÆ Count votes per Addon ID
    const voteCountMap = {};
    votes.forEach(vote => {
      voteCountMap[vote.addon_id] = (voteCountMap[vote.addon_id] || 0) + 1;
    });

    // üåü Mod of the Day
    const latestDaily = dailyMods[dailyMods.length - 1];
    const modOfTheDay = latestDaily && modMap[latestDaily["Addon ID"]];

    if (modOfTheDay) {
      modContainer.innerHTML = `
        <div class="mods-header">üåü Mod of the Day</div>
        <div class="mod-card featured">
          <h3>${modOfTheDay["Addon Name"] || "Unnamed Mod"}</h3>
          <p style="color: #888;">${voteCountMap[modOfTheDay["Addon ID"]] || 0} vote(s)</p>
        </div>
      `;
    } else {
      modContainer.innerHTML = `<p>‚ö†Ô∏è No Mod of the Day selected.</p>`;
    }

    // üèÜ Build leaderboard
    const sorted = Object.entries(voteCountMap)
      .map(([addonId, votes]) => ({
        addonId,
        name: modMap[addonId]?.["Addon Name"] || addonId,
        votes
      }))
      .sort((a, b) => b.votes - a.votes)
      .slice(0, 10);

    leaderboardContainer.innerHTML = "";

    sorted.forEach((mod, index) => {
      const rank = index + 1;
      const emoji = rank === 1 ? "üëë" : rank <= 3 ? "üî•" : "‚≠ê";

      const entry = document.createElement("div");
      entry.className = rank === 1
        ? "winner"
        : rank <= 3
          ? "following-winners"
          : "others";

      entry.style.margin = "10px 0";
      entry.style.fontSize = "1.1rem";

      entry.innerHTML = `
        ${emoji} <strong>#${rank}</strong> ‚Äî 
        <span style="font-weight: bold;">${mod.name}</span> 
        <span style="color: #888;">(${mod.votes} vote${mod.votes !== 1 ? "s" : ""})</span>
      `;

      leaderboardContainer.appendChild(entry);
    });

  } catch (err) {
    leaderboardContainer.textContent = "‚ö†Ô∏è Failed to load leaderboard.";
    console.error("Leaderboard error:", err);
  }
}

loadLeaderboard();
const themeToggle = document.getElementById("themeToggle");

// Apply saved theme on load
if (localStorage.getItem("theme") === "dark") {
  document.body.classList.add("dark-mode");
}

// Toggle and save preference
themeToggle.addEventListener("click", (e) => {
  e.preventDefault();
  document.body.classList.toggle("dark-mode");

  // Save preference
  if (document.body.classList.contains("dark-mode")) {
    localStorage.setItem("theme", "dark");
  } else {
    localStorage.setItem("theme", "light");
  }
});

    const targets = document.querySelectorAll('.welcome-text, .welcome-para');

    targets.forEach(el => {
      el.addEventListener('mousemove', e => {
        const rect = el.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;

        el.style.setProperty('--mouse-x', `${x}px`);
        el.style.setProperty('--mouse-y', `${y}px`);
      });

      el.addEventListener('mouseleave', () => {
        el.style.setProperty('--mouse-x', `50%`);
        el.style.setProperty('--mouse-y', `50%`);
      });
    });
  </script>
<footer class="site-footer">
  <p>¬© NeonJet Studios. <strong>Bloxd World</strong> is made by NeonJet Studios and is not affiliated with Bloxd.io.</p>
  <nav class="footer-links">
    <a href="/about">About</a>
    <a href="/leaderboard">Leaderboard</a>
    <a href="/about">About</a>
    <a href="/upload">Submit a Mod</a>
    <a href="https://discord.gg/yourserver" target="_blank">Join Discord (SOON)</a>
  </nav>
</footer>
</body>
</html>
